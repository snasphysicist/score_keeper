<DOCTYPE! html>
<html lang="en">
  <head>
    <title>FIGHT!</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="static/run_duel/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  </head>
  <body>
    <div id="vue" class="grid-container page-contatiner">
      <p>
        {% verbatim %}{{ duel.opponent1.battle_name }}{% endverbatim %}
        vs
        {% verbatim %}{{ duel.opponent2.battle_name }}{% endverbatim %}
      </p>
      <p>Total HP: {% verbatim %}{{ totalOpponent1Score }} : {{ totalOpponent2Score }}{% endverbatim %}</p>
      <div class="grid-container">
        <div class="grid-container two-columns">
          <h2>Round {% verbatim %}{{ roundNumberDisplay }}{% endverbatim %}</h2>
          <p>Status: {% verbatim %}{{ roundStatusDisplay }}{% endverbatim %}</p>
          <p id="time">Time Remaining: {% verbatim %}{{ currentRoundTimeRemaining }}{% endverbatim %}</p>
          <p>HP: {% verbatim %}{{ currentRoundOpponent1Score }} : {{ currentRoundOpponent2Score }}{% endverbatim %}</p>
        </div>
        <div class="grid-container two-columns">
          <input id="start-round"
                 {% if can_record_score %} onclick="submitEvent(event)" {% endif %}
                 type="button" value="Start Next Round"/>
          <input id="pause-round"
                 {% if can_record_score %}  onclick="submitEvent(event)" {% endif %}
                 type="button" value="Pause"/>
          <input id="finish-round"
                 {% if can_record_score %} onclick="submitEvent(event)" {% endif %}
                 type="button" value="Finish"/>
          <input id="continue-round"
                 {% if can_record_score %} onclick="submitEvent(event)" {% endif %}
                 type="button" value="Continue"/>
        </div>
      </div>
      <div class="grid-container">
        <div class="grid-container two-columns">
          <h2>{% verbatim %}{{ duel.opponent1.battle_name }}{% endverbatim %}</h2>
          <p id="hp1">HP: {% verbatim %}{{ currentRoundOpponent1Score }}{% endverbatim %}</p>
        </div>
        <div class="grid-container three-columns">
          <input id="opponent-1-head"
                 {% if can_record_score %} onclick="submitEvent(event)" {% endif %}
                 type="button" value="Head">
          <input id="opponent-1-hand"
                 {% if can_record_score %} onclick="submitEvent(event)" {% endif %}
                 type="button" value="Hand">
          <input id="opponent-1-body"
                 {% if can_record_score %} onclick="submitEvent(event)" {% endif %}
                 type="button" value="Body">
        </div>
      </div>
      <div class="grid-container">
        <div class="grid-container two-columns">
          <h2>{% verbatim %}{{ duel.opponent2.battle_name }}{% endverbatim %}</h2>
          <p id="hp2">HP: {% verbatim %}{{ currentRoundOpponent2Score }}{% endverbatim %}</p>
        </div>
        <div class="grid-container three-columns">
          <input id="opponent-2-head"
                 {% if can_record_score %} onclick="submitEvent(event)" {% endif %}
                 type="button" value="Head">
          <input id="opponent-2-hand"
                 {% if can_record_score %} onclick="submitEvent(event)" {% endif %}
                 type="button" value="Hand">
          <input id="opponent-2-body"
                 {% if can_record_score %} onclick="submitEvent(event)" {% endif %}
                 type="button" value="Body">
        </div>
      </div>
    </div>
  </body>
  <script type="text/javascript" src="static/run_duel/current/application.js">
  </script>
  {% if can_record_score %}
  <script type="text/javascript">
    function submitEvent(event) {
      let eventType = event.target.id;
      const POST_URL = "/run_duel/api/v1/event"
      let data = {
        "type": eventType
      }
      fetch(
        POST_URL,
        {
          method: "POST",
          body: JSON.stringify(data)
        }
      ).then((response) => {
          if (!response.ok) {
            // Handle error
          }
      })
    }
  </script>
  {% endif %}
</html>
